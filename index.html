<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Pedidos de Tamales</title>
    <!-- Carga de Tailwind CSS -->
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <!-- En lugar de la CDN, usa esta versión más estable -->
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    
    <!-- Configuración para usar la fuente Inter -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'tamal-green': '#38761d',
                        'tamal-red': '#cc0000',
                    }
                }
            }
        }
    </script>
    
</head>
<body class="p-4 sm:p-8 min-h-screen flex flex-col items-center justify-start">

    <nav class="w-full max-w-4xl flex gap-4 mb-6 px-4">
        <button id="nav-new-order" class="flex-1 py-2 font-bold border-b-4 border-tamal-green text-tamal-green">
            Nuevo Pedido
        </button>
        <button id="nav-query-orders" class="flex-1 py-2 font-bold border-b-4 border-transparent text-gray-500 hover:text-tamal-green">
            Consultar Pedidos
        </button>
    </nav>

    <div id="app" class="w-full max-w-4xl bg-white rounded-2xl p-6 sm:p-10 card">
    <div id="app" class="w-full max-w-4xl bg-white rounded-2xl p-6 sm:p-10 card">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-tamal-green mb-8 text-center">
            ¡Haz tu Pedido de Tamales!
        </h1>

        <!-- Mensaje de Carga y Errores -->
        <div id="message-area" class="mb-4 text-center"></div>

        <div id="query-section" class="hidden space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2 mb-4">Consultar Historial de Pedidos</h2>
            
            <div class="space-y-4">
                <label class="block text-sm font-medium text-gray-700">Selecciona un Cliente:</label>
                <select id="client-selector" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-tamal-green focus:ring-tamal-green py-3 px-4 border">
                    <option value="" disabled selected>Cargando clientes...</option>
                </select>
            </div>

            <div id="query-results" class="mt-8 space-y-8">
                </div>
        </div>


        <!-- SECCIÓN 1: FORMULARIO DE CLIENTE Y TAMALES -->
        <div id="customer-form-section" class="space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2 mb-4">
                1. Datos del Cliente
            </h2>
            <div class="space-y-4">
                <input type="text" id="nombre" placeholder="Nombre completo y/o apodo" class="input-lg" required>
                <input type="tel" id="telefono" placeholder="Numero de Teléfono o whatsapp" class="input-lg" required>
                <input type="text" id="direccion" placeholder="Dirección de entrega" class="input-lg" required>
                <input type="text" id="referencia" placeholder="Lugar de referencia u observaciones" class="input-lg">
                <div class="flex flex-col sm:flex-row gap-4">
                    <button id="capture-gps-btn" type="button" class="btn-secondary w-full">
                        <svg class="w-6 h-6 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        Capturar Ubicación (GPS)
                    </button>
                    <input type="text" id="gps-coords" placeholder="Coordenadas GPS (opcional)" class="input-lg bg-gray-50 flex-grow" readonly>
                </div>
            </div>

            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2 mb-4 mt-8">
                2. Agregar Tamales
            </h2>

            <!-- Contenedor para la lista de tamales dinámicos -->
            <div id="tamal-list" class="space-y-6">
                <!-- Los items de tamales se insertarán aquí por JS -->
            </div>

            <button type="button" id="add-tamal-btn" class="btn-secondary w-full flex items-center justify-center space-x-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                <span>Añadir Tamal</span>
            </button>
            
            <div class="pt-8 flex justify-center">
                <button type="button" id="next-step-btn" class="btn-primary w-full sm:w-auto">
                    Finalizar y Revisar Pedido
                </button>
            </div>
        </div>

        <!-- SECCIÓN 2: RESUMEN DEL PEDIDO -->
        <div id="summary-section" class="hidden space-y-6">
            <h2 class="text-3xl font-bold text-tamal-green border-b-4 border-tamal-green pb-3 mb-6 text-center">
                Resumen de tu Pedido
            </h2>
            
            <!-- Datos del Cliente Resumidos -->
            <div class="bg-gray-100 p-4 rounded-lg">
                <h3 class="text-xl font-semibold mb-2 text-gray-700">Datos de Contacto y Entrega</h3>
                <p><strong class="font-medium">Nombre:</strong> <span id="summary-nombre"></span></p>
                <p><strong class="font-medium">Teléfono:</strong> <span id="summary-telefono"></span></p>
                <p><strong class="font-medium">Dirección:</strong> <span id="summary-direccion"></span></p>
                <p><strong class="font-medium">Referencia:</strong> <span id="summary-referencia"></span></p>
                <p><strong class="font-medium">GPS:</strong> <span id="summary-gps"></span></p>
            </div>

            <!-- Tabla de Pedidos -->
            <h3 class="text-xl font-semibold mt-6 mb-2 text-gray-700">Detalle de Tamales</h3>
            <div id="summary-tamales-table" class="overflow-x-auto">
                <!-- La tabla de tamales se genera aquí por JS -->
            </div>
            
            <!-- Botones de Acción -->
            <div class="pt-8 flex flex-col sm:flex-row gap-4 justify-center">
                <button type="button" id="modify-order-btn" class="btn-secondary">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-7-1.414l3.293 3.293-3.293 3.293m-4.243-4.243l3.293 3.293-3.293 3.293"></path></svg>
                    Modificar Pedido
                </button>
                
                <!-- NUEVO BOTÓN: Descargar PDF -->
                <button type="button" id="download-pdf-btn" class="btn-secondary">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    Descargar Pedido (PDF)
                </button>

                <button type="button" id="confirm-send-btn" class="btn-primary">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.416A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.64A11.955 11.955 0 002 12c0 2.977 1.258 5.672 3.293 7.502L12 22l6.707-2.498C20.742 17.672 22 14.977 22 12c0-3.046-1.077-5.875-3.093-8.056z"></path></svg>
                    Confirmar y Enviar Pedido
                </button>
            </div>
        </div>

        <!-- SECCIÓN 3: MENSAJE DE ÉXITO -->
        <div id="success-section" class="hidden text-center py-12">
            <svg class="w-20 h-20 text-tamal-green mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <h2 class="text-3xl font-bold text-tamal-green mb-4">¡Pedido Enviado con Éxito!</h2>
            <p class="text-lg text-gray-600">
                Tu pedido de tamales ha sido enviado. Recibirás una confirmación. ¡Pronto disfrutarás de tu deliciosa orden!
            </p>
            <button type="button" id="new-order-btn" class="btn-secondary mt-8">
                Hacer un Nuevo Pedido
            </button>
        </div>

    </div>
    <script src="script.js"></script>
</body>
</html>
